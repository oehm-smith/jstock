/*
 * This build file was auto generated by running the Gradle 'init' task
 * by 'bsmith' at '14/12/14 10:09 AM' with Gradle 1.12
 *
 * This generated file contains a commented-out sample Java project to get you started.
 * For more details take a look at the Java Quickstart chapter in the Gradle
 * user guide available at http://gradle.org/docs/1.12/userguide/tutorial_java_projects.html
 */


apply plugin: 'java'
apply plugin:'application'

sourceCompatibility = 1.7
targetCompatibility = 1.7

mainClassName='org.yccheok.jstock.gui.JStock'
archivesBaseName='jstock'
version='1.1.0'
libsDirName='dist'

repositories {
    mavenCentral()
	mavenLocal()
	// Configuration for jstock's dependencies being in the libs/ directory
   	flatDir {
		dirs 'libs'
	}
}

sourceSets {
    main {
        java {
            srcDir 'src'
        }
        resources {
            srcDir 'resources'
        }
    }
    test {
        java {
            srcDir 'test'
        }
    }
}

dependencies {
	// javaFx dependency
	compile fileTree(dir: "${System.properties['java.home']}", include: '**/jfxrt.jar')
	
    compile 'org.slf4j:slf4j-api:1.7.5'

	// jstock dependencies
	compile name: 'blobsallad/blobsallad'
	compile name: 'xstream/cglib-nodep-2.2'
	compile name: 'commons-codec-1.3'
	compile name: 'commons-httpclient-3.1-rc1'
	compile name: 'commons-lang-2.4/commons-lang-2.4'
	compile name: 'commons-logging-1.1'
	compile name: 'commons-net-1.4.1'
	compile name: 'commons-validator/commons-validator-1.3.1'
	compile name: 'xstream/dom4j-1.6.1'
	compile name: 'forms-1.1.0'
	compile name: 'drive/libs/google-api-client-1.18.0-rc'
	compile name: 'drive/libs/google-api-client-java6-1.18.0-rc'
	compile name: 'calendar/google-api-services-calendar-v3-rev82-1.18.0-rc'
	compile name: 'drive/google-api-services-drive-v2-rev120-1.18.0-rc'
	compile name: 'oauth2/google-api-services-oauth2-v2-rev68-1.18.0-rc'
	compile name: 'drive/libs/google-http-client-1.18.0-rc'
	compile name: 'drive/libs/google-http-client-gson-1.18.0-rc'
	compile name: 'drive/libs/google-oauth-client-1.18.0-rc'
	compile name: 'drive/libs/google-oauth-client-java6-1.18.0-rc'
	compile name: 'drive/libs/google-oauth-client-jetty-1.18.0-rc'
	compile name: 'google-gson-2.2.4/gson-2.2.4'
	compile name: 'drive/libs/httpclient-4.0.1'
	compile name: 'drive/libs/httpcore-4.0.1'
	compile name: 'commons-validator/jakarta-oro-2.0.8'
	compile name: 'jasypt-1.5/dist/jasypt-1.5'
	compile name: 'jfreechart/jcommon-1.0.16'
	compile name: 'xstream/jdom-1.1'
	compile name: 'drive/libs/jetty-6.1.26'
	compile name: 'drive/libs/jetty-util-6.1.26'
	compile name: 'jfreechart/jfreechart-1.0.13'
	compile name: 'jh'
	compile name: 'jhotdraw7/JHotDraw7'
	compile name: 'xstream/joda-time-1.6'
	compile name: 'drive/libs/jsr305-1.3.9'
	compile name: 'jxlayer/jxlayer'
	compile name: 'xstream/kxml2-2.3.0'
	compile name: 'l2fprod-common-all'
	compile name: 'mail'
	compile name: 'nachocalendar-0.23/lib/nachocalendar-0.23'
	compile name: 'opencsv/opencsv-2.3'
	compile name: 'pinyin4j-2.5.0/lib/pinyin4j-2.5.0'
	compile name: 'poi-3.2-FINAL/poi-3.2-FINAL-20081019'
	compile name: 'drive/libs/servlet-api-2.5-20081211'
	compile name: 'xstream/stax-1.2.0'
	compile name: 'xstream/stax-api-1.0.1'
	compile name: 'swing-layout-1.0'
	compile name: 'swingx/swingx-0.9.6'
	compile name: 'TA-Lib/ta-lib-0.4.0'
	compile name: 'xstream/xml-writer-0.2'
	compile name: 'xstream/xom-1.1'
	compile name: 'xstream/xpp3_min-1.1.4c'
	compile name: 'xstream/xstream-1.4.2'
	
    testCompile "junit:junit:4.11"
}

task copyToLib(type: Copy) {
    from configurations.runtime
    into "$libsDir/libs"
}

build.dependsOn(copyToLib)
assemble.dependsOn(copyToLib)

// The current jstock project has its distribution going to a <project>/dist directory.  Run this explicitly
task distribute(type: Copy) {
	from "$libsDir"
	into "$projectDir/dist"
}

task cleanDistribute(type: Delete) {
	delete "$projectDir/dist"
}


distribute.dependsOn(cleanDistribute)
distribute.dependsOn(build)

jar {
	dependsOn configurations.runtime
    //from {
    //    configurations.runtime
    //} {
        //exclude "META-INF/*.SF"
        // ..
    //}
//	configurations.compile.each { print "${it.getName()} "}; println('')
    manifest {
        attributes (
        	'Main-Class': 'org.yccheok.jstock.gui.JStock',
			//'Class-Path': configurations.compile.collect { it.getName() }.join(' libs/')
			'Class-Path': configurations.compile.collect { "libs/${it.getName()}"}.join(' ')
		)
    }
}

